<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PROJECT NOCTURNE</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    body { margin:0; background:#000; color:#d0d0d0; font-family:"Courier New", monospace; overflow:hidden; }
    #map { height:100vh; width:100%; }
    .header { position:absolute; top:10px; left:20px; z-index:1000; font-size:12px; opacity:0.6; }
    .glow-marker { background:red; width:10px; height:10px; border-radius:50%; box-shadow:0 0 8px red,0 0 16px red; }
    #sidePanel { position:fixed; right:-320px; top:0; width:300px; height:100%; background:#0a0a0a; border-left:1px solid #111; overflow-y:auto; padding:10px; transition:0.3s; z-index:1000; }
    #sidePanel.active { right:0; }
    .toggleBtn { position:absolute; right:20px; top:10px; font-size:12px; cursor:pointer; opacity:0.6; }
  </style>
</head>
<body>

<div class="header">PROJECT NOCTURNE</div>
<div class="toggleBtn" onclick="togglePanel()">ARCHIVE</div>
<div id="sidePanel"></div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  // Load logs from LocalStorage
  let logs = JSON.parse(localStorage.getItem("nocturneLogs")) || [];

  const map = L.map('map').setView([41.9981,21.4254],6);

  L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',{ attribution:'Â© OpenStreetMap contributors' }).addTo(map);

  const icon = L.divIcon({ html:'<div class="glow-marker"></div>', iconSize:[10,10] });

  // Load existing logs
  logs.forEach(log => { createLog(log.lat, log.lng, log.text, log.time); });

  // Click map to add log
  map.on('click', function(e){
    const text = prompt("LOG ENTRY (max 120 chars)");
    if(!text) return;
    const time = new Date().toLocaleString();
    const log = { lat:e.latlng.lat, lng:e.latlng.lng, text, time };
    logs.push(log);
    localStorage.setItem("nocturneLogs", JSON.stringify(logs));
    createLog(e.latlng.lat,e.latlng.lng,text,time);
  });

  function createLog(lat,lng,text,time){
    const marker = L.marker([lat,lng],{icon}).addTo(map);
    marker.bindPopup(`<strong>LOG ENTRY</strong><br>${text}<br/><small>${time}</small>`);

    // Add to side panel
    const panel = document.getElementById("sidePanel");
    panel.innerHTML += `<div>${text}<br/><small>${time}</small><hr/></div>`;
  }

  function togglePanel(){
    document.getElementById("sidePanel").classList.toggle("active");
  }
</script>
</body>
</html>



