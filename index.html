<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fjolla & Une Project</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  body { font-family:'Inter',sans-serif; margin:0; padding:0; background:#121212; color:#eee; }
  .tabs { display:flex; justify-content:center; background:#1e1e1e; }
  .tab { padding:12px 25px; cursor:pointer; border-bottom:3px solid transparent; font-weight:600; transition:0.2s; }
  .tab:hover { background:#2a2a2a; }
  .tab.active { border-bottom:3px solid #f1c40f; }
  .tab-content { display:none; padding:20px; max-width:900px; margin:20px auto; }
  .tab-content.active { display:block; }
  #mapContainer { width:100%; max-width:800px; height:400px; margin:0 auto 10px; border-radius:12px; overflow:hidden; box-shadow:0 4px 20px rgba(0,0,0,0.5); }
  #sidePanel { max-height:150px; overflow-y:auto; border-top:1px solid #444; padding-top:5px; }
  input, button { padding:8px 12px; margin-top:5px; background:#1e1e1e; border:1px solid #444; border-radius:6px; color:#eee; outline:none; transition:0.2s; }
  input:focus { border-color:#f1c40f; }
  button:hover { background:#2a2a2a; cursor:pointer; }
  .glow-marker { width:14px; height:14px; background:#f1c40f; border-radius:50%; box-shadow:0 0 10px #f1c40f; }
  hr { border-color:#444; }
  #passwordOverlay { position:fixed; top:0; left:0; width:100%; height:100%; background:#121212; color:#eee; display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:9999; }
</style>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
  // --- FIREBASE CONFIG ---
  const firebaseConfig = {
    apiKey: "AIzaSyBk7vpprHqVv1ILc4rruIiS4bSZRzkQs1Y",
    authDomain: "sdasasdasd-6eb06.firebaseapp.com",
    projectId: "sdasasdasd-6eb06",
    storageBucket: "sdasasdasd-6eb06.firebasestorage.app",
    messagingSenderId: "983557131474",
    appId: "1:983557131474:web:c6858896718d6e10b3f10b"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>
</head>
<body>

<!-- PASSWORD -->
<div id="passwordOverlay">
  <h2>Enter Password</h2>
  <input type="password" id="sitePassword" placeholder="Password"/>
  <button onclick="checkPassword()">Enter</button>
  <div id="passwordError" style="color:red; margin-top:10px;"></div>
</div>

<!-- TABS -->
<div class="tabs">
  <div class="tab active" data-tab="mapTab">Map</div>
  <div class="tab" data-tab="historyTab">Music Facts</div>
  <div class="tab" data-tab="songTab">Song Log</div>
</div>

<div id="mapTab" class="tab-content active">
  <div id="mapContainer"></div>
  <div id="sidePanel">Loading archive...</div>
</div>

<div id="historyTab" class="tab-content">
  <div id="musicFact">Loading music fact...</div>
</div>

<div id="songTab" class="tab-content">
  <input type="text" id="songInput" placeholder="Add a song"/>
  <button id="addSongBtn">Add Song</button>
  <div id="songs">Loading...</div>
</div>

<script>
  // --- PASSWORD ---
  const correctPassword = "music123";
  function checkPassword() {
    const val = document.getElementById("sitePassword").value;
    if(val===correctPassword) document.getElementById("passwordOverlay").style.display="none";
    else document.getElementById("passwordError").innerText="Incorrect password!";
  }

  // --- TABS ---
  const tabs=document.querySelectorAll('.tab');
  const contents=document.querySelectorAll('.tab-content');
  tabs.forEach(tab=>tab.addEventListener('click',()=>{
    tabs.forEach(t=>t.classList.remove('active'));
    contents.forEach(c=>c.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab).classList.add('active');
  }));

  // --- MAP ---
  const map=L.map('mapContainer').setView([41.9981,21.4254],6);
  L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',{ attribution:'© OpenStreetMap contributors' }).addTo(map);
  const icon = L.divIcon({ html:'<div class="glow-marker"></div>', iconSize:[14,14] });

  function loadPins(){
    const panel=document.getElementById("sidePanel");
    panel.innerText="Loading archive...";
    db.collection("pins").orderBy("time","asc").get().then(snapshot=>{
      panel.innerHTML="";
      snapshot.forEach(doc=>{
        const pin=doc.data();
        L.marker([pin.lat,pin.lng],{icon}).addTo(map).bindPopup(`<strong>LOG ENTRY</strong><br>${pin.text}<br/><small>${pin.time.toDate().toLocaleString()}</small>`);
        panel.innerHTML+=`<div>${pin.text}<br/><small>${pin.time.toDate().toLocaleString()}</small><hr/></div>`;
      });
      if(snapshot.empty) panel.innerText="No pins yet.";
    });
  }

  map.on('click',e=>{
    const text=prompt("LOG ENTRY (max 120 chars)");
    if(!text) return;
    const time=firebase.firestore.Timestamp.now();
    db.collection("pins").add({lat:e.latlng.lat,lng:e.latlng.lng,text,text,time})
      .then(()=>loadPins())
      .catch(err=>alert("Error adding pin: "+err));
  });

  loadPins();

  // --- SONG LOG ---
  const songsContainer=document.getElementById("songs");
  const songInput=document.getElementById("songInput");
  const addSongBtn=document.getElementById("addSongBtn");

  function loadSongs(){
    songsContainer.innerText="Loading...";
    db.collection("songs").orderBy("time","asc").get().then(snapshot=>{
      songsContainer.innerHTML="";
      snapshot.forEach(doc=>{
        const song=doc.data();
        songsContainer.innerHTML+=`<div>${song.text}<hr/></div>`;
      });
      if(snapshot.empty) songsContainer.innerText="No songs logged yet.";
    });
  }

  addSongBtn.addEventListener("click",()=>{
    const val=songInput.value.trim();
    if(!val) return;
    const time=firebase.firestore.Timestamp.now();
    db.collection("songs").add({text:val,time}).then(()=>{
      songInput.value="";
      loadSongs();
    }).catch(err=>alert("Error adding song: "+err));
  });

  loadSongs();

  // --- MUSIC FACTS ---
  const facts=[
    "Beethoven composed some of his best works while completely deaf.",
    "Mozart started composing at age 5.",
    "Vivaldi was nicknamed 'The Red Priest'.",
    "Johann Sebastian Bach had 20 children.",
    "Frederic Chopin wrote mostly for solo piano.",
    "Louis Armstrong popularized scat singing.",
    "The Beatles hold the record for most number-one hits in the UK.",
    "Opera originated in Italy at the end of the 16th century.",
    "Antonio Stradivari crafted some of the world's finest violins.",
    "Handel wrote 'Messiah' in just 24 days.",
    "Jazz originated in New Orleans in the late 19th century.",
    "Beethoven’s Ninth Symphony includes a choral finale.",
    "Tchaikovsky wrote the Nutcracker ballet."
  ];

  function showFact(){
    const today=new Date();
    const index=today.getDate()%facts.length;
    document.getElementById("musicFact").innerText=facts[index];
  }

  showFact();
</script>
</body>
</html>


